# Сравнение производительности regex-библиотек

## Описание тестирования

Тестирование производительности операций `match` и `search` будет проводиться для следующих библиотек:
- `std::regex` (стандартная библиотека C++)
- `boost::regex` (Boost.Regex)
- PCRE (Perl Compatible Regular Expressions)

## Тестовые данные

Для сравнения будут использоваться два текстовых файла:

1. **match.txt** (~272 МБ):
   - Содержит 13373573 строк
   - Используется для тестирования базовой функциональности
   - Примерный размер: 16 384 байт
   - Разбит на 11 файлов из-за требований GitHub'а
   - Разбиение влияет на время работы тестов, но на анализ результатов не влияет
   - Приведенные результаты тестирования получены при объдинение всех 11 файлов воедино

2. **Большой файл** ("Война и мир" на английском):
   - Полный текст романа Л.Н. Толстого
   - Используется для тестирования производительности на большом объеме данных
   - Примерный размер: ~3.2 МБ
   - Будет использоваться для поиска различных литературных паттернов

## Методика тестирования

1. **Операции:**
   - `match` - полное совпадение с шаблоном
   - `search` - поиск всех вхождений шаблона

2. **Тестовые шаблоны:**
   - Простые регулярные выражения (например, `\w+`)
   - Средней сложности (например, `[A-Z][a-z]+`)
   - Сложные выражения (например, `(?=\b\w{6}\b)\w{0,6}ing`)

3. **Измеряемые параметры:**
   - Время выполнения операций

## Ожидаемые результаты

Результаты будут представлены в виде таблицы сравнения:
- Время выполнения каждой операции
- Относительная производительность библиотек

## Требования к окружению

- Компилятор с поддержкой C++17
- Установленные библиотеки:
  - Boost 1.86
  - PCRE2 8-битная версия

## Регулярные выражения для тестирования отдельных слов

| Название паттерна | Регулярное выражение | Описание |
|-------------------|-----------------------|----------|
| **Lowercase** | `^[a-z]+$` | Строка содержит только строчные буквы |
| **Digits only** | `^\d+$` | Строка содержит только цифры |
| **4 alnum chars** | `^\w{4}$` | Строка содержит ровно 4 буквенно-цифровых символа |
| **Capitalized** | `^[A-Z][a-z]+$` | Строка начинается с заглавной буквы, остальные строчные |
| **Words ending with 'ing'** | `^[a-z]+ing$` | Слова на английском, оканчивающиеся на "ing" |
| **Simple ID pattern** | `^\d{3}-\d{2}-\d{4}$` | Идентификаторы формата XXX-XX-XXXX (цифры) |
| **Password pattern** | `^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).{8,}$` | Пароль: минимум 8 символов, хотя бы одна заглавная, одна строчная буква и цифра |
| **Vowel-consonant alternation** | `^([aeiou][^aeiou])+[aeiou]?$` | Чередование гласных и согласных (английские буквы) |
| **5-letter palindromes** | `^(.)(.).\2\1$` | 5-буквенные палиндромы (слова, читающиеся одинаково в обе стороны) |

## Регулярные выражения для анализа "Войны и мира"

| Название паттерна | Регулярное выражение | Описание |
|-------------------|-----------------------|----------|
| **Russian names** | `\b[A-Z][a-z]*(ov\|ev\|in\|sky\|aya)\b` | Русские фамилии с характерными окончаниями |
| **French phrases** | `\b[a-zA-ZÀ-ÿ]+\s[a-zA-ZÀ-ÿ]+\b` | Французские фразы (два слова с французскими символами) |
| **Military terms** | `\b(regiment\|battalion\|cavalry\|infantry\|artillery)\b` | Военные термины на английском |
| **Aristocratic titles** | `\b(Prince\|Count\|Countess\|Baron\|Duchess)\s[A-Z][a-z]+\b` | Аристократические титулы с именами |
| **Nature descriptions** | `\b(sunset\|moonlight\|snow\|forest\|river\|field)s?\b` | Описания природы |
| **Emotional expressions** | `\b(sighed\|wept\|laughed\|exclaimed\|whispered)\b` | Глаголы, выражающие эмоции |
| **Historical dates** | `\b(1[0-9]{3}\|20[0-9]{2})\b` | Даты с 1000 по 2099 год |
| **Philosophical terms** | `\b(life\|death\|love\|war\|peace\|destiny)\b` | Философские понятия |
| **Long sentences** | `\b(\w+\W+){20,}\w+\b` | Длинные предложения (20+ слов) |

## Особенности паттернов:

1. Для слов:
   - Используются якоря `^` и `$` для точного соответствия всей строке
   - Шаблоны проверяют конкретные лингвистические особенности
   - Парольный паттерн использует lookahead assertions для сложных проверок

2. Для "Войны и мира":
   - Используются границы слов `\b` для поиска в тексте
   - Учитываются особенности русского и французского языков
   - Шаблоны захватывают тематические элементы романа
   - Регулярки оптимизированы для работы с большими текстами


# Описание скрипта
## Функции для сравнения (match)
### `test_std_regex_match`
**Назначение**: Тестирование операции точного соответствия (match) с использованием стандартной библиотеки `std::regex`  
**Параметры**:
- `words` - вектор строк для тестирования
- `pattern_name` - название шаблона
- `pattern` - регулярное выражение  
**Особенности**:
- Замеряет время выполнения для статистики
- Обрабатывает исключения при ошибках компиляции шаблона
- Сохраняет результаты в `all_results`

### `test_boost_regex_match`
**Назначение**: Тестирование операции match с использованием библиотеки Boost.Regex  
**Отличия от std::regex**:
- Использует более оптимизированный движок регулярных выражений
- Поддерживает дополнительные синтаксические возможности
- Обычно работает быстрее на сложных шаблонах

### `test_pcre_match`
**Назначение**: Тестирование операции match с использованием библиотеки PCRE2  
**Ключевые особенности**:
- Наиболее полная поддержка Perl-совместимых регулярных выражений
- Позволяет точно контролировать параметры компиляции
- Имеет расширенную систему обработки ошибок

## Функции поиска в тексте

### `test_std_regex_search`
**Назначение**: Поиск всех вхождений шаблона в тексте с использованием `std::regex`  
**Алгоритм работы**:
1. Компилирует регулярное выражение
2. Использует `sregex_iterator` для поиска всех совпадений
3. Подсчитывает количество вхождений
4. Замеряет время выполнения

### `test_boost_regex_search`
**Назначение**: Поиск вхождений с использованием Boost.Regex  
**Преимущества**:
- Более эффективный алгоритм поиска
- Поддержка Unicode-символов
- Возможность работы с большими текстами

### `test_pcre_search`
**Назначение**: Поиск вхождений с использованием PCRE2  
**Особенности реализации**:
- Использует ручное управление памятью (pcre2_code*, pcre2_match_data*)
- Обрабатывает совпадения через смещения (offset)
- Поддерживает JIT-компиляцию для ускорения

## Вспомогательные функции

### `warmup_cache`
**Назначение**: Прогрев кэша процессора перед тестированием  
**Как работает**: Проходит по всем словам, выполняя простые операции

### `read_file_to_string`
**Назначение**: Чтение всего файла в строку  
**Особенности**: Использует эффективный метод с итераторами

### `print_test_result`
**Назначение**: Форматированный вывод результатов теста  
**Формат вывода**: таблица, содержащая название функции, библиотеку, название патерна, количество отрабатываний и время работы

# Анализ результатов тестирования регулярных выражений

## Общие наблюдения

### Производительность библиотек
- **PCRE** демонстрирует наилучшую скорость во всех тестах (в **5-15 раз быстрее** `std::regex`)
- **Boost.Regex** занимает промежуточное положение (в **2-5 раз быстрее** `std::regex`)
- **Std.Regex** значительно отстаёт по скорости, особенно на сложных паттернах

### Корректность работы
- Все библиотеки дают **одинаковое количество совпадений** для каждого паттерна
- Подтверждается **корректность реализации** регулярных выражений во всех библиотеках

## Детальный анализ операций MATCH

### Простые паттерны
| Паттерн          | PCRE (мкс) | Boost (мкс) | Std (мкс) | Разрыв PCRE/std |
|------------------|-----------|------------|----------|----------------|
| Lowercase        | 1,834,534 | 12,488,483 | 24,637,192 | **13.4x**       |
| Digits only      | 529,744   | 10,649,289 | 11,854,701 | **22.4x**       |

**Выводы:**
- PCRE обрабатывает 1.3 млн слов за **1.8-2.2 мс**
- На простых паттернах разрыв с std::regex минимален (в **2-3 раза**)

### Паттерны средней сложности
| Паттерн          | PCRE (мкс) | Boost (мкс) | Std (мкс) |
|------------------|-----------|------------|----------|
| 4 alnum chars    | 932,234   | 11,216,468 | 15,878,021 |
| Capitalized      | 682,495   | 10,677,607 | 13,453,776 |

**Особенности:**
- PCRE сохраняет лидерство (**0.5-0.9 мс**)
- Std::regex тратит до **15 мс** на те же операции

### Сложные паттерны
| Паттерн               | PCRE (мкс) | Boost (мкс) | Std (мкс)    |
|-----------------------|-----------|------------|-------------|
| Password pattern      | 5,536,926 | 16,969,759 | 120,019,028 |
| 5-letter palindromes  | 1,539,522 | 16,549,524 | 19,469,713  |

**Ключевые моменты:**
- PCRE в **10-20 раз быстрее** std::regex
- Особенно заметно на проверке паролей (**5.5 мс vs 120 мс**)

## Детальный анализ операций SEARCH

### Локализованные поиски
| Паттерн              | PCRE (мкс) | Boost (мкс) | Std (мкс) |
|----------------------|-----------|------------|----------|
| Russian names        | 22,819    | 71,944     | 1,265,792 |
| Military terms       | 30,133    | 137,174    | 1,439,187 |

**Характеристики:**
- PCRE обрабатывает текст за **20-30 мс**
- Std::regex требует **1.2-1.5 секунд**

### Широкие поиски
| Паттерн         | Совпадений | PCRE (мкс) | Boost (мкс) | Std (мкс) |
|----------------|-----------|-----------|------------|----------|
| French phrases | 263,294   | 38,531    | 335,214    | 1,012,754 |

**Особенности:**
- На 263K совпадений PCRE тратит **37 мс**
- Std::regex - почти **1 секунду**

### Ресурсоёмкие паттерны
| Паттерн         | PCRE (мкс) | Boost (мкс) | Std (мкс) |
|----------------|-----------|------------|----------|
| Long sentences  | 173,985   | 1,933,960  | 3,630,017 |

**Проблемы:**
- Даже PCRE замедляется до **174 мс**
- Std::regex требует **3.6 секунды**

